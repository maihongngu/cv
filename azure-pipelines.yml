# Node.js with React
# Build a Node.js project that uses React.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/javascript

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'
  
steps:
- checkout: self
  persistCredentials: true
- task: NodeTool@0
  inputs:
    knownHostsEntry: 'SHA256:Hnbm9TSCkXriJl6Vj16Guxjq9ZXQcz8zBzn/mxVA0Kk vjpking5913@gmail.com'
    sshPublicKey: 'AAAAB3NzaC1yc2EAAAABIwAAAQEAq2A7hRGmdnm9tUDbO9IDSwBK6TbQa+PXYPCPy6rbTrTtw7PHkccKrpp0yVhp5HdEIcKr6pLlVDBfOLX9QUsyCOV0wzfjIJNlGEYsdlLJizHhbn2mUjvSAHQqZETYP81eFzLQNnPHt4EVVUh7VfDESU84KezmD5QlWpXLmvU31/yMf+Se8xhHTvKSCZIFImWwoG6mbUoWf9nzpIoaSjB+weqqUUmpaaasXVal72J+UX2B+2RPW3RcT0eOzQgqlJL3RKrTJvdsjE3JEAvGq3lGHSZXy28G3skua2SmVi/w4yCE6gbODqnTWlg7+wC604ydGXA8VJiS5ap43JXiUFFAaQ=='
    sshKeySecureFile: 'azure_rsa'
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    npm install
    npm run build
    git config --global user.email "vjpking5913@gmail.com"
    git config --global user.name "Ngu Mai"
    git remote set-url origin git@github.com:maihongngu/cv.git
    npm run deploy-clean
    npm run deploy
  displayName: 'npm install and build'
